server:
  port: 8090

spring:
  config:
    import: "aws-parameterstore:/config/synthetiq/"
  autoconfigure:
    exclude:
      - org.springframework.ai.model.bedrock.cohere.autoconfigure.BedrockCohereEmbeddingAutoConfiguration
      - org.springframework.ai.model.bedrock.titan.autoconfigure.BedrockTitanEmbeddingAutoConfiguration
      - org.springframework.ai.model.ollama.autoconfigure.OllamaChatAutoConfiguration
      - org.springframework.ai.model.ollama.autoconfigure.OllamaApiAutoConfiguration
      - org.springframework.ai.model.ollama.autoconfigure.OllamaEmbeddingAutoConfiguration
  datasource:
    url: jdbc:postgresql://${db.host}:5432/synthetiq?sslmode=require
    username: ${db.username}
    password: ${db.password}
    hikari:
      maximum-pool-size: 15
      minimum-idle: 3
      connection-timeout: 10000
      leak-detection-threshold: 60000
  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: none
    properties:
      hibernate:
        boot:
          allow_jdbc_metadata_access: false
  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration
  ai:
    model:
      chat: bedrock-converse
    bedrock:
      converse:
        chat:
          enabled: true
          options:
            model: amazon.nova-micro-v1:0   # default; overridden per-tier at runtime
            temperature: 0.1
      aws:
        region: us-east-1
    ollama:
      enabled: false

spring.cloud.aws:
  region:
    static: us-east-1
  sqs:
    listener:
      max-concurrent-messages: 3
      max-messages-per-poll: 3
      visibility-timeout: 180  # 3 min: covers 120s agent timeout + buffer

synthetiq:
  ai:
    default-tier: CHEAP
    max-tier: SMART
  sqs:
    review-queue: https://sqs.us-east-1.amazonaws.com/585853725115/synthetiq-review-tasks

logging:
  level:
    dev.synthetiq: INFO
    root: WARN

